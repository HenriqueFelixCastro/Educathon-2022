{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n/**\n * Copyright IBM Corp. 2020, 2021\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\nimport { AnalyticsAPI } from '../Analytics';\nimport root from 'window-or-global';\n/**\n * Sets the Kaltura Partner ID, set by environment variable \"KALTURA_PARTNER_ID\"\n *\n * @type {number}\n * @private\n */\n\nvar _partnerId = process && (process.env.REACT_APP_KALTURA_PARTNER_ID || process.env.KALTURA_PARTNER_ID) || 1773841;\n/**\n * Sets the Kaltura UIConf ID, set by environment variable \"KALTURA_UICONF_ID\"\n *\n * @type {number}\n * @private\n */\n\n\nvar _uiConfId = process && (process.env.REACT_APP_KALTURA_UICONF_ID || process.env.KALTURA_UICONF_ID) || 27941801;\n/**\n * @type {string} _embedUrl The API URL to call\n * @private\n */\n\n\nvar _embedUrl = \"https://cdnapisec.kaltura.com/p/\".concat(_partnerId, \"/sp/\").concat(_partnerId, \"00/embedIframeJs/uiconf_id/\").concat(_uiConfId, \"/partner_id/\").concat(_partnerId);\n/**\n * @type {string} _thumbnailUrl\n * @private\n */\n\n\nvar _thumbnailUrl = \"https://cdnsecakmi.kaltura.com/p/\".concat(_partnerId, \"/thumbnail/entry_id/\");\n/**\n * Number of times to retry the script ready loop before failing\n *\n * @type {number}\n * @private\n */\n\n\nvar _timeoutRetries = 50;\n/**\n * Tracks the number of attempts for the script ready loop\n *\n * @type {number}\n * @private\n */\n\nvar _attempt = 0;\n/**\n * Tracks the script status\n *\n * @type {boolean} _scriptLoading to track the script loading or not\n * @private\n */\n\nvar _scriptLoading = false;\n/**\n * Timeout loop to check script state is the _scriptLoaded state or _scriptLoading state\n *\n * @param {Function} resolve Resolve function\n * @param {Function} reject Reject function\n * @private\n */\n\nfunction _scriptReady(resolve, reject) {\n  /**\n   *\n   * @param {object} root.kWidget if exists then resolve\n   */\n  if (root.kWidget) {\n    _scriptLoading = false;\n    resolve();\n  } else if (_scriptLoading) {\n    _attempt++;\n\n    if (_attempt < _timeoutRetries) {\n      setTimeout(function () {\n        _scriptReady(resolve, reject);\n      }, 100);\n    } else {\n      reject();\n    }\n  } else {\n    _loadScript();\n\n    _scriptReady(resolve, reject);\n  }\n}\n/**\n * Returns boolean if the _scriptLoading and _scriptLoaded flag is false\n *\n * @private\n */\n\n\nfunction _loadScript() {\n  _scriptLoading = true;\n  var script = document.createElement('script');\n  script.src = _embedUrl;\n  script.async = true;\n  document.body.appendChild(script);\n}\n/**\n *\n * Object to cache media data\n *\n * @private\n */\n\n\nvar mediaData = {};\n/**\n * KalturaPlayerAPI class with methods of checking script state and\n * embed media meta data and api data\n *\n * In order to set the Partner ID/UIConf ID, set the following environment\n * variables:\n *\n * - KALTURA_PARTNER_ID\n * - KALTURA_UICONF_ID\n */\n\nvar KalturaPlayerAPI = /*#__PURE__*/function () {\n  function KalturaPlayerAPI() {\n    _classCallCheck(this, KalturaPlayerAPI);\n  }\n\n  _createClass(KalturaPlayerAPI, null, [{\n    key: \"checkScript\",\n\n    /**\n     *\n     * Gets the full _scriptReady state\n     *\n     * @returns {Promise<*>} Promise kaltura media player file\n     */\n    value: function checkScript() {\n      return new Promise(function (resolve, reject) {\n        _scriptReady(resolve, reject);\n      });\n    }\n    /**\n     * Creates thumbnail image url with customizable params\n     *\n     * @param {object} params param object\n     * @param {string} params.mediaId media id\n     * @param {string} params.height specify height in pixels\n     * @param {string} params.width specify width in pixels\n     *\n     * @returns {string} url of thumbnail image\n     *\n     * @example\n     * import { KalturaPlayerAPI } from '@carbon/ibmdotcom-services';\n     *\n     * function thumbnail() {\n     *   const thumbnailData = {\n     *      mediaId: '1_9h94wo6b',\n     *      height: '240',\n     *      width: '320'\n     *   }\n     *   const thumbnailUrl = KalturaPlayerAPI.getThumbnailUrl(thumbnailData);\n     * }\n     */\n\n  }, {\n    key: \"getThumbnailUrl\",\n    value: function getThumbnailUrl(_ref) {\n      var mediaId = _ref.mediaId,\n          height = _ref.height,\n          width = _ref.width;\n      var url = _thumbnailUrl + mediaId;\n      if (height) url = url + \"/height/\".concat(height);\n      if (width) url = url + \"/width/\".concat(width);\n      return url;\n    }\n    /**\n     * Gets the embed meta data\n     *\n     * @param {string} mediaId  The mediaId we're embedding the placeholder for.\n     * @param {string} targetId The targetId the ID where we're putting the placeholder.\n     * @param {object} flashvars Determine any extra param or plugin for the player.\n     * @param {boolean} useIbmMetrics Whether or not should IBM Metrics events be fired.\n     * @param {Function} customReadyCallback Determine any extra functions that should be executed\n     *  on player readyCallback.\n     * @returns {object}  object\n     *\n     * @example\n     * import { KalturaPlayerAPI } from '@carbon/ibmdotcom-services';\n     *\n     * function embedMyVideo() {\n     *   const elem = document.getElementById('foo');\n     *   const videoid = '12345';\n     *   KalturaPlayerAPI.embedMedia(videoid, elem);\n     * }\n     */\n\n  }, {\n    key: \"embedMedia\",\n    value: function () {\n      var _embedMedia = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(mediaId, targetId) {\n        var flashvars,\n            useIbmMetrics,\n            customReadyCallback,\n            fireEvent,\n            _args = arguments;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                flashvars = _args.length > 2 && _args[2] !== undefined ? _args[2] : {};\n                useIbmMetrics = _args.length > 3 && _args[3] !== undefined ? _args[3] : true;\n                customReadyCallback = _args.length > 4 && _args[4] !== undefined ? _args[4] : function () {};\n                fireEvent = this.fireEvent;\n                _context.next = 6;\n                return this.checkScript().then(function () {\n                  var promiseKWidget = new Promise(function (resolve) {\n                    var defaultFlashVars = {\n                      autoPlay: true,\n                      closedCaptions: {\n                        plugin: true\n                      },\n                      titleLabel: {\n                        plugin: true,\n                        align: 'left',\n                        text: '{mediaProxy.entry.name}'\n                      },\n                      ibm: {\n                        template: 'idl'\n                      }\n                    };\n                    var isCustomCreated;\n\n                    if (!document.getElementById(targetId) && document.querySelector('dds-tabs-extended-media')) {\n                      var newVideoDiv = document.createElement('div');\n                      newVideoDiv.classList.add(\"bx--video-player__video\");\n                      newVideoDiv.setAttribute('id', targetId);\n                      document.body.append(newVideoDiv);\n                      isCustomCreated = true;\n                    }\n\n                    root.kWidget.embed({\n                      targetId: targetId,\n                      wid: '_' + _partnerId,\n                      uiconf_id: _uiConfId,\n                      entry_id: mediaId,\n                      flashvars: _objectSpread(_objectSpread({}, defaultFlashVars), flashvars),\n                      params: {\n                        wmode: 'transparent'\n                      },\n                      // Ready callback is issued for this player:\n                      readyCallback: function readyCallback(playerId) {\n                        var kdp = document.getElementById(playerId);\n\n                        if (useIbmMetrics) {\n                          kdp.addJsListener('playerPaused.ibm', function () {\n                            fireEvent({\n                              playerState: 1,\n                              kdp: kdp,\n                              mediaId: mediaId\n                            });\n                          });\n                          kdp.addJsListener('playerPlayed.ibm', function () {\n                            fireEvent({\n                              playerState: 2,\n                              kdp: kdp,\n                              mediaId: mediaId\n                            });\n                          });\n                          kdp.addJsListener('playerPlayEnd.ibm', function () {\n                            fireEvent({\n                              playerState: 3,\n                              kdp: kdp,\n                              mediaId: mediaId\n                            });\n                          });\n                          kdp.addJsListener('IbmCtaEvent.ibm', function (ctaData) {\n                            var customMetricsData = (ctaData === null || ctaData === void 0 ? void 0 : ctaData.customMetricsData) || {};\n                            fireEvent({\n                              playerState: 101,\n                              kdp: kdp,\n                              mediaId: mediaId,\n                              customMetricsData: customMetricsData\n                            });\n                          });\n                        }\n\n                        customReadyCallback(kdp);\n                        resolve(kdp);\n                      }\n                    });\n\n                    if (isCustomCreated) {\n                      var previousVideoDiv = document.querySelector('dds-tabs-extended-media').shadowRoot.querySelector(\".bx--accordion__item--active dds-video-player\").lastChild;\n                      previousVideoDiv.parentElement.appendChild(document.getElementById(targetId));\n                    }\n                  });\n                  return {\n                    kWidget: function kWidget() {\n                      return promiseKWidget;\n                    }\n                  };\n                });\n\n              case 6:\n                return _context.abrupt(\"return\", _context.sent);\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function embedMedia(_x, _x2) {\n        return _embedMedia.apply(this, arguments);\n      }\n\n      return embedMedia;\n    }()\n    /**\n     * Fires a metrics event when the media was played.\n     * Pass events to common metrics event.\n     *\n     * @param {object} param params\n     * @param {number} param.playerState state detecting different user actions\n     * @param {object} param.kdp media object\n     * @param {string} param.mediaId id of the media\n     * @param {object} param.customMetricsData any extra parameter for custom events\n     *\n     */\n\n  }, {\n    key: \"fireEvent\",\n    value: function fireEvent(_ref2) {\n      var playerState = _ref2.playerState,\n          kdp = _ref2.kdp,\n          mediaId = _ref2.mediaId,\n          _ref2$customMetricsDa = _ref2.customMetricsData,\n          customMetricsData = _ref2$customMetricsDa === void 0 ? {} : _ref2$customMetricsDa; // If media was played and timestamp is 0, it should be \"launched\" state.\n\n      var currentTime = Math.round(kdp.evaluate('{video.player.currentTime}'));\n\n      if (playerState === 2 && currentTime === 0) {\n        playerState = 0;\n      }\n\n      var eventData = {\n        playerType: 'kaltura',\n        title: kdp.evaluate('{mediaProxy.entry.name}'),\n        currentTime: currentTime,\n        duration: kdp.evaluate('{mediaProxy.entry.duration}'),\n        playerState: playerState,\n        mediaId: mediaId,\n        customMetricsData: customMetricsData\n      };\n      AnalyticsAPI.videoPlayerStats(eventData);\n    }\n    /**\n     * Gets the api data\n     *\n     * @param {string} mediaId  The mediaId we're embedding the placeholder for.\n     * @returns {object}  object\n     *\n     * @example\n     * import { KalturaPlayerAPI } from '@carbon/ibmdotcom-services';\n     *\n     * async function getMyVideoInfo(id) {\n     *   const data = await KalturaPlayerAPI.api(id);\n     *   console.log(data);\n     * }\n     */\n\n  }, {\n    key: \"api\",\n    value: function () {\n      var _api = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(mediaId) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this.checkScript().then(function () {\n                  if (mediaData && mediaData[mediaId]) {\n                    return mediaData[mediaId];\n                  } else {\n                    return new Promise(function (resolve) {\n                      return new root.kWidget.api({\n                        wid: '_' + _partnerId\n                      }).doRequest({\n                        service: 'media',\n                        action: 'get',\n                        entryId: mediaId\n                      }, function (jsonObj) {\n                        mediaData[jsonObj.id] = jsonObj;\n                        resolve(jsonObj);\n                      });\n                    });\n                  }\n                });\n\n              case 2:\n                return _context2.abrupt(\"return\", _context2.sent);\n\n              case 3:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function api(_x3) {\n        return _api.apply(this, arguments);\n      }\n\n      return api;\n    }()\n    /**\n     * Convert media duration from milliseconds and seconds to HH:MM:SS\n     *\n     * @param {string} duration media duration in seconds\n     * @param {boolean} fromMilliseconds the duration argument is expressed in milliseconds rather than seconds\n     * @returns {string} converted duration\n     */\n\n  }, {\n    key: \"getMediaDuration\",\n    value: function getMediaDuration() {\n      var _root$kWidget;\n\n      var duration = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      var fromMilliseconds = arguments.length > 1 ? arguments[1] : undefined;\n\n      if (fromMilliseconds) {\n        var _seconds = Math.floor(duration / 1000 % 60);\n\n        var _minutes = Math.floor(duration / (1000 * 60) % 60);\n\n        var _hours = Math.floor(duration / (1000 * 60 * 60) % 24);\n\n        _hours = _hours > 0 ? _hours + ':' : '';\n        _seconds = _seconds < 10 ? '0' + _seconds : _seconds;\n        return duration && '(' + _hours + _minutes + ':' + _seconds + ')';\n      }\n\n      var parsedTime = (root === null || root === void 0 ? void 0 : (_root$kWidget = root.kWidget) === null || _root$kWidget === void 0 ? void 0 : _root$kWidget.seconds2Measurements(duration)) || {};\n      var hours = (parsedTime === null || parsedTime === void 0 ? void 0 : parsedTime.hours) || 0;\n      var minutes = (parsedTime === null || parsedTime === void 0 ? void 0 : parsedTime.minutes) || 0;\n      var seconds = (parsedTime === null || parsedTime === void 0 ? void 0 : parsedTime.seconds) || 0;\n      minutes = (hours > 0 ? '0' + minutes : minutes).toString().slice(-2);\n      hours = hours > 0 ? hours + ':' : '';\n      seconds = ('0' + seconds).slice(-2);\n      return hours + minutes + ':' + seconds;\n    }\n  }, {\n    key: \"getMediaDurationFormatted\",\n    value: function getMediaDurationFormatted() {\n      var duration = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      var fromMilliseconds = arguments.length > 1 ? arguments[1] : undefined;\n      var ms = duration;\n\n      if (!fromMilliseconds) {\n        ms = duration * 1000;\n      }\n\n      var s = Math.floor(ms / 1000 % 60);\n      var m = Math.floor(ms / (1000 * 60) % 60);\n      var h = Math.floor(ms / (1000 * 60 * 60) % 24);\n      var seconds = KalturaPlayerAPI.formatTime(s, 'second');\n      var minutes = h || m ? KalturaPlayerAPI.formatTime(m, 'minute') : '';\n      var hours = h ? KalturaPlayerAPI.formatTime(h, 'hour') : '';\n      return \"\".concat(hours, \" \").concat(minutes, \" \").concat(seconds).trim();\n    }\n  }, {\n    key: \"formatTime\",\n    value: function formatTime(number, unit) {\n      var locale = root.document.documentElement.lang || root.navigator.language;\n      return new Intl.NumberFormat(locale, {\n        style: 'unit',\n        // @ts-ignore: TS lacking support for standard option\n        unitDisplay: 'long',\n        unit: unit\n      }).format(number);\n    }\n  }]);\n\n  return KalturaPlayerAPI;\n}();\n\nexport default KalturaPlayerAPI;","map":{"version":3,"sources":["/Users/henriquefelixcastro/Downloads/Educathon 2022/educathon-2022-website/node_modules/@carbon/ibmdotcom-react/es/internal/vendor/@carbon/ibmdotcom-services/services/KalturaPlayer/KalturaPlayer.js"],"names":["_defineProperty","_asyncToGenerator","_classCallCheck","_createClass","_regeneratorRuntime","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","getOwnPropertyDescriptors","defineProperties","defineProperty","AnalyticsAPI","root","_partnerId","process","env","REACT_APP_KALTURA_PARTNER_ID","KALTURA_PARTNER_ID","_uiConfId","REACT_APP_KALTURA_UICONF_ID","KALTURA_UICONF_ID","_embedUrl","concat","_thumbnailUrl","_timeoutRetries","_attempt","_scriptLoading","_scriptReady","resolve","reject","kWidget","setTimeout","_loadScript","script","document","createElement","src","async","body","appendChild","mediaData","KalturaPlayerAPI","value","checkScript","Promise","getThumbnailUrl","_ref","mediaId","height","width","url","_embedMedia","mark","_callee","targetId","flashvars","useIbmMetrics","customReadyCallback","fireEvent","_args","wrap","_callee$","_context","prev","next","undefined","then","promiseKWidget","defaultFlashVars","autoPlay","closedCaptions","plugin","titleLabel","align","text","ibm","template","isCustomCreated","getElementById","querySelector","newVideoDiv","classList","add","setAttribute","append","embed","wid","uiconf_id","entry_id","params","wmode","readyCallback","playerId","kdp","addJsListener","playerState","ctaData","customMetricsData","previousVideoDiv","shadowRoot","lastChild","parentElement","abrupt","sent","stop","embedMedia","_x","_x2","_ref2","_ref2$customMetricsDa","currentTime","Math","round","evaluate","eventData","playerType","title","duration","videoPlayerStats","_api","_callee2","_callee2$","_context2","api","doRequest","service","action","entryId","jsonObj","id","_x3","getMediaDuration","_root$kWidget","fromMilliseconds","_seconds","floor","_minutes","_hours","parsedTime","seconds2Measurements","hours","minutes","seconds","toString","slice","getMediaDurationFormatted","ms","s","m","h","formatTime","trim","number","unit","locale","documentElement","lang","navigator","language","Intl","NumberFormat","style","unitDisplay","format"],"mappings":"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","sourcesContent":["import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n/**\n * Copyright IBM Corp. 2020, 2021\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport { AnalyticsAPI } from '../Analytics';\nimport root from 'window-or-global';\n/**\n * Sets the Kaltura Partner ID, set by environment variable \"KALTURA_PARTNER_ID\"\n *\n * @type {number}\n * @private\n */\n\nvar _partnerId = process && (process.env.REACT_APP_KALTURA_PARTNER_ID || process.env.KALTURA_PARTNER_ID) || 1773841;\n/**\n * Sets the Kaltura UIConf ID, set by environment variable \"KALTURA_UICONF_ID\"\n *\n * @type {number}\n * @private\n */\n\n\nvar _uiConfId = process && (process.env.REACT_APP_KALTURA_UICONF_ID || process.env.KALTURA_UICONF_ID) || 27941801;\n/**\n * @type {string} _embedUrl The API URL to call\n * @private\n */\n\n\nvar _embedUrl = \"https://cdnapisec.kaltura.com/p/\".concat(_partnerId, \"/sp/\").concat(_partnerId, \"00/embedIframeJs/uiconf_id/\").concat(_uiConfId, \"/partner_id/\").concat(_partnerId);\n/**\n * @type {string} _thumbnailUrl\n * @private\n */\n\n\nvar _thumbnailUrl = \"https://cdnsecakmi.kaltura.com/p/\".concat(_partnerId, \"/thumbnail/entry_id/\");\n/**\n * Number of times to retry the script ready loop before failing\n *\n * @type {number}\n * @private\n */\n\n\nvar _timeoutRetries = 50;\n/**\n * Tracks the number of attempts for the script ready loop\n *\n * @type {number}\n * @private\n */\n\nvar _attempt = 0;\n/**\n * Tracks the script status\n *\n * @type {boolean} _scriptLoading to track the script loading or not\n * @private\n */\n\nvar _scriptLoading = false;\n/**\n * Timeout loop to check script state is the _scriptLoaded state or _scriptLoading state\n *\n * @param {Function} resolve Resolve function\n * @param {Function} reject Reject function\n * @private\n */\n\nfunction _scriptReady(resolve, reject) {\n  /**\n   *\n   * @param {object} root.kWidget if exists then resolve\n   */\n  if (root.kWidget) {\n    _scriptLoading = false;\n    resolve();\n  } else if (_scriptLoading) {\n    _attempt++;\n\n    if (_attempt < _timeoutRetries) {\n      setTimeout(function () {\n        _scriptReady(resolve, reject);\n      }, 100);\n    } else {\n      reject();\n    }\n  } else {\n    _loadScript();\n\n    _scriptReady(resolve, reject);\n  }\n}\n/**\n * Returns boolean if the _scriptLoading and _scriptLoaded flag is false\n *\n * @private\n */\n\n\nfunction _loadScript() {\n  _scriptLoading = true;\n  var script = document.createElement('script');\n  script.src = _embedUrl;\n  script.async = true;\n  document.body.appendChild(script);\n}\n/**\n *\n * Object to cache media data\n *\n * @private\n */\n\n\nvar mediaData = {};\n/**\n * KalturaPlayerAPI class with methods of checking script state and\n * embed media meta data and api data\n *\n * In order to set the Partner ID/UIConf ID, set the following environment\n * variables:\n *\n * - KALTURA_PARTNER_ID\n * - KALTURA_UICONF_ID\n */\n\nvar KalturaPlayerAPI = /*#__PURE__*/function () {\n  function KalturaPlayerAPI() {\n    _classCallCheck(this, KalturaPlayerAPI);\n  }\n\n  _createClass(KalturaPlayerAPI, null, [{\n    key: \"checkScript\",\n\n    /**\n     *\n     * Gets the full _scriptReady state\n     *\n     * @returns {Promise<*>} Promise kaltura media player file\n     */\n    value: function checkScript() {\n      return new Promise(function (resolve, reject) {\n        _scriptReady(resolve, reject);\n      });\n    }\n    /**\n     * Creates thumbnail image url with customizable params\n     *\n     * @param {object} params param object\n     * @param {string} params.mediaId media id\n     * @param {string} params.height specify height in pixels\n     * @param {string} params.width specify width in pixels\n     *\n     * @returns {string} url of thumbnail image\n     *\n     * @example\n     * import { KalturaPlayerAPI } from '@carbon/ibmdotcom-services';\n     *\n     * function thumbnail() {\n     *   const thumbnailData = {\n     *      mediaId: '1_9h94wo6b',\n     *      height: '240',\n     *      width: '320'\n     *   }\n     *   const thumbnailUrl = KalturaPlayerAPI.getThumbnailUrl(thumbnailData);\n     * }\n     */\n\n  }, {\n    key: \"getThumbnailUrl\",\n    value: function getThumbnailUrl(_ref) {\n      var mediaId = _ref.mediaId,\n          height = _ref.height,\n          width = _ref.width;\n      var url = _thumbnailUrl + mediaId;\n      if (height) url = url + \"/height/\".concat(height);\n      if (width) url = url + \"/width/\".concat(width);\n      return url;\n    }\n    /**\n     * Gets the embed meta data\n     *\n     * @param {string} mediaId  The mediaId we're embedding the placeholder for.\n     * @param {string} targetId The targetId the ID where we're putting the placeholder.\n     * @param {object} flashvars Determine any extra param or plugin for the player.\n     * @param {boolean} useIbmMetrics Whether or not should IBM Metrics events be fired.\n     * @param {Function} customReadyCallback Determine any extra functions that should be executed\n     *  on player readyCallback.\n     * @returns {object}  object\n     *\n     * @example\n     * import { KalturaPlayerAPI } from '@carbon/ibmdotcom-services';\n     *\n     * function embedMyVideo() {\n     *   const elem = document.getElementById('foo');\n     *   const videoid = '12345';\n     *   KalturaPlayerAPI.embedMedia(videoid, elem);\n     * }\n     */\n\n  }, {\n    key: \"embedMedia\",\n    value: function () {\n      var _embedMedia = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(mediaId, targetId) {\n        var flashvars,\n            useIbmMetrics,\n            customReadyCallback,\n            fireEvent,\n            _args = arguments;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                flashvars = _args.length > 2 && _args[2] !== undefined ? _args[2] : {};\n                useIbmMetrics = _args.length > 3 && _args[3] !== undefined ? _args[3] : true;\n                customReadyCallback = _args.length > 4 && _args[4] !== undefined ? _args[4] : function () {};\n                fireEvent = this.fireEvent;\n                _context.next = 6;\n                return this.checkScript().then(function () {\n                  var promiseKWidget = new Promise(function (resolve) {\n                    var defaultFlashVars = {\n                      autoPlay: true,\n                      closedCaptions: {\n                        plugin: true\n                      },\n                      titleLabel: {\n                        plugin: true,\n                        align: 'left',\n                        text: '{mediaProxy.entry.name}'\n                      },\n                      ibm: {\n                        template: 'idl'\n                      }\n                    };\n                    var isCustomCreated;\n\n                    if (!document.getElementById(targetId) && document.querySelector('dds-tabs-extended-media')) {\n                      var newVideoDiv = document.createElement('div');\n                      newVideoDiv.classList.add(\"bx--video-player__video\");\n                      newVideoDiv.setAttribute('id', targetId);\n                      document.body.append(newVideoDiv);\n                      isCustomCreated = true;\n                    }\n\n                    root.kWidget.embed({\n                      targetId: targetId,\n                      wid: '_' + _partnerId,\n                      uiconf_id: _uiConfId,\n                      entry_id: mediaId,\n                      flashvars: _objectSpread(_objectSpread({}, defaultFlashVars), flashvars),\n                      params: {\n                        wmode: 'transparent'\n                      },\n                      // Ready callback is issued for this player:\n                      readyCallback: function readyCallback(playerId) {\n                        var kdp = document.getElementById(playerId);\n\n                        if (useIbmMetrics) {\n                          kdp.addJsListener('playerPaused.ibm', function () {\n                            fireEvent({\n                              playerState: 1,\n                              kdp: kdp,\n                              mediaId: mediaId\n                            });\n                          });\n                          kdp.addJsListener('playerPlayed.ibm', function () {\n                            fireEvent({\n                              playerState: 2,\n                              kdp: kdp,\n                              mediaId: mediaId\n                            });\n                          });\n                          kdp.addJsListener('playerPlayEnd.ibm', function () {\n                            fireEvent({\n                              playerState: 3,\n                              kdp: kdp,\n                              mediaId: mediaId\n                            });\n                          });\n                          kdp.addJsListener('IbmCtaEvent.ibm', function (ctaData) {\n                            var customMetricsData = (ctaData === null || ctaData === void 0 ? void 0 : ctaData.customMetricsData) || {};\n                            fireEvent({\n                              playerState: 101,\n                              kdp: kdp,\n                              mediaId: mediaId,\n                              customMetricsData: customMetricsData\n                            });\n                          });\n                        }\n\n                        customReadyCallback(kdp);\n                        resolve(kdp);\n                      }\n                    });\n\n                    if (isCustomCreated) {\n                      var previousVideoDiv = document.querySelector('dds-tabs-extended-media').shadowRoot.querySelector(\".bx--accordion__item--active dds-video-player\").lastChild;\n                      previousVideoDiv.parentElement.appendChild(document.getElementById(targetId));\n                    }\n                  });\n                  return {\n                    kWidget: function kWidget() {\n                      return promiseKWidget;\n                    }\n                  };\n                });\n\n              case 6:\n                return _context.abrupt(\"return\", _context.sent);\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function embedMedia(_x, _x2) {\n        return _embedMedia.apply(this, arguments);\n      }\n\n      return embedMedia;\n    }()\n    /**\n     * Fires a metrics event when the media was played.\n     * Pass events to common metrics event.\n     *\n     * @param {object} param params\n     * @param {number} param.playerState state detecting different user actions\n     * @param {object} param.kdp media object\n     * @param {string} param.mediaId id of the media\n     * @param {object} param.customMetricsData any extra parameter for custom events\n     *\n     */\n\n  }, {\n    key: \"fireEvent\",\n    value: function fireEvent(_ref2) {\n      var playerState = _ref2.playerState,\n          kdp = _ref2.kdp,\n          mediaId = _ref2.mediaId,\n          _ref2$customMetricsDa = _ref2.customMetricsData,\n          customMetricsData = _ref2$customMetricsDa === void 0 ? {} : _ref2$customMetricsDa;\n      // If media was played and timestamp is 0, it should be \"launched\" state.\n      var currentTime = Math.round(kdp.evaluate('{video.player.currentTime}'));\n\n      if (playerState === 2 && currentTime === 0) {\n        playerState = 0;\n      }\n\n      var eventData = {\n        playerType: 'kaltura',\n        title: kdp.evaluate('{mediaProxy.entry.name}'),\n        currentTime: currentTime,\n        duration: kdp.evaluate('{mediaProxy.entry.duration}'),\n        playerState: playerState,\n        mediaId: mediaId,\n        customMetricsData: customMetricsData\n      };\n      AnalyticsAPI.videoPlayerStats(eventData);\n    }\n    /**\n     * Gets the api data\n     *\n     * @param {string} mediaId  The mediaId we're embedding the placeholder for.\n     * @returns {object}  object\n     *\n     * @example\n     * import { KalturaPlayerAPI } from '@carbon/ibmdotcom-services';\n     *\n     * async function getMyVideoInfo(id) {\n     *   const data = await KalturaPlayerAPI.api(id);\n     *   console.log(data);\n     * }\n     */\n\n  }, {\n    key: \"api\",\n    value: function () {\n      var _api = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(mediaId) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this.checkScript().then(function () {\n                  if (mediaData && mediaData[mediaId]) {\n                    return mediaData[mediaId];\n                  } else {\n                    return new Promise(function (resolve) {\n                      return new root.kWidget.api({\n                        wid: '_' + _partnerId\n                      }).doRequest({\n                        service: 'media',\n                        action: 'get',\n                        entryId: mediaId\n                      }, function (jsonObj) {\n                        mediaData[jsonObj.id] = jsonObj;\n                        resolve(jsonObj);\n                      });\n                    });\n                  }\n                });\n\n              case 2:\n                return _context2.abrupt(\"return\", _context2.sent);\n\n              case 3:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function api(_x3) {\n        return _api.apply(this, arguments);\n      }\n\n      return api;\n    }()\n    /**\n     * Convert media duration from milliseconds and seconds to HH:MM:SS\n     *\n     * @param {string} duration media duration in seconds\n     * @param {boolean} fromMilliseconds the duration argument is expressed in milliseconds rather than seconds\n     * @returns {string} converted duration\n     */\n\n  }, {\n    key: \"getMediaDuration\",\n    value: function getMediaDuration() {\n      var _root$kWidget;\n\n      var duration = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      var fromMilliseconds = arguments.length > 1 ? arguments[1] : undefined;\n\n      if (fromMilliseconds) {\n        var _seconds = Math.floor(duration / 1000 % 60);\n\n        var _minutes = Math.floor(duration / (1000 * 60) % 60);\n\n        var _hours = Math.floor(duration / (1000 * 60 * 60) % 24);\n\n        _hours = _hours > 0 ? _hours + ':' : '';\n        _seconds = _seconds < 10 ? '0' + _seconds : _seconds;\n        return duration && '(' + _hours + _minutes + ':' + _seconds + ')';\n      }\n\n      var parsedTime = (root === null || root === void 0 ? void 0 : (_root$kWidget = root.kWidget) === null || _root$kWidget === void 0 ? void 0 : _root$kWidget.seconds2Measurements(duration)) || {};\n      var hours = (parsedTime === null || parsedTime === void 0 ? void 0 : parsedTime.hours) || 0;\n      var minutes = (parsedTime === null || parsedTime === void 0 ? void 0 : parsedTime.minutes) || 0;\n      var seconds = (parsedTime === null || parsedTime === void 0 ? void 0 : parsedTime.seconds) || 0;\n      minutes = (hours > 0 ? '0' + minutes : minutes).toString().slice(-2);\n      hours = hours > 0 ? hours + ':' : '';\n      seconds = ('0' + seconds).slice(-2);\n      return hours + minutes + ':' + seconds;\n    }\n  }, {\n    key: \"getMediaDurationFormatted\",\n    value: function getMediaDurationFormatted() {\n      var duration = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      var fromMilliseconds = arguments.length > 1 ? arguments[1] : undefined;\n      var ms = duration;\n\n      if (!fromMilliseconds) {\n        ms = duration * 1000;\n      }\n\n      var s = Math.floor(ms / 1000 % 60);\n      var m = Math.floor(ms / (1000 * 60) % 60);\n      var h = Math.floor(ms / (1000 * 60 * 60) % 24);\n      var seconds = KalturaPlayerAPI.formatTime(s, 'second');\n      var minutes = h || m ? KalturaPlayerAPI.formatTime(m, 'minute') : '';\n      var hours = h ? KalturaPlayerAPI.formatTime(h, 'hour') : '';\n      return \"\".concat(hours, \" \").concat(minutes, \" \").concat(seconds).trim();\n    }\n  }, {\n    key: \"formatTime\",\n    value: function formatTime(number, unit) {\n      var locale = root.document.documentElement.lang || root.navigator.language;\n      return new Intl.NumberFormat(locale, {\n        style: 'unit',\n        // @ts-ignore: TS lacking support for standard option\n        unitDisplay: 'long',\n        unit: unit\n      }).format(number);\n    }\n  }]);\n\n  return KalturaPlayerAPI;\n}();\n\nexport default KalturaPlayerAPI;"]},"metadata":{},"sourceType":"module"}