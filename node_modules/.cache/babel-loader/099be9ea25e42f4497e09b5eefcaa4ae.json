{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n/**\n * Copyright IBM Corp. 2016, 2022\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React, { useState, useEffect } from 'react';\nimport AudioPLayerCaptionsMenu from './AudioPlayerCaptionsMenu';\nimport AudioPlayerCaptionText from './AudioPlayerCaptionText';\nimport AudioPlayerPlaybackRateMenu from './AudioPlayerPlaybackRateMenu';\nimport AudioPlayerPlayButton from './AudioPlayerPlayButton';\nimport AudioPlayerScrubber from './AudioPlayerScrubber';\nimport AudioPlayerThumbnail from './AudioPlayerThumbnail';\nimport AudioPlayerVolumeControl from './AudioPlayerVolumeControl';\nimport cx from 'classnames';\nimport { DDS_AUDIO_PLAYER } from '../../internal/FeatureFlags';\nimport ddsSettings from '../../internal/vendor/@carbon/ibmdotcom-utilities/utilities/settings/settings';\nimport { KalturaPlayer as KalturaPlayerAPI } from '@carbon/ibmdotcom-services/es/services';\nimport PropTypes from 'prop-types';\nimport root from 'window-or-global';\nimport settings from 'carbon-components/es/globals/js/settings';\nimport uniqueid from '../../internal/vendor/@carbon/ibmdotcom-utilities/utilities/uniqueid/uniqueid';\nvar stablePrefix = ddsSettings.stablePrefix;\nvar prefix = settings.prefix;\n/**\n * AudioPlayer component.\n */\n\nvar AudioPlayer = function AudioPlayer(_ref) {\n  var audioId = _ref.audioId,\n      customClassName = _ref.customClassName,\n      autoPlay = _ref.autoPlay,\n      showCaptionMenu = _ref.showCaptionMenu,\n      showPlaybackRateMenu = _ref.showPlaybackRateMenu,\n      availablePlaybackRates = _ref.availablePlaybackRates;\n\n  var _useState = useState({\n    duration: 0\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      audioData = _useState2[0],\n      setAudioData = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      displayVolumeControl = _useState4[0],\n      setDisplayVolumeControl = _useState4[1];\n\n  var audioPlayerId = uniqueid(\"audio-player__audio-\".concat(audioId, \"-\"));\n  var uniqueAudioPlayerId = \"\".concat(prefix, \"--\").concat(audioPlayerId);\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      kalturaDigitalPlayer = _useState6[0],\n      setKalturaDigitalPlayer = _useState6[1]; // The KDP Object\n\n\n  var _useState7 = useState({}),\n      _useState8 = _slicedToArray(_useState7, 2),\n      availableCaptions = _useState8[0],\n      setAvailableCaptions = _useState8[1]; // All Available Captions\n\n  /**\n   * The current state of the player\n   *\n   * @param {string} '' - Player not initialized\n   * @param {string} 'loading' - Player initialized but waiting kdp to load\n   * @param {string} 'playing' - Player is playing\n   * @param {string} 'paused' - Player is paused\n   * @param {string} 'stopped' - Player stopped playing (audio finished)\n   */\n\n\n  var _useState9 = useState(''),\n      _useState10 = _slicedToArray(_useState9, 2),\n      audioState = _useState10[0],\n      setAudioState = _useState10[1];\n\n  var _useState11 = useState(1),\n      _useState12 = _slicedToArray(_useState11, 2),\n      audioVolume = _useState12[0],\n      setAudioVolume = _useState12[1]; // Current Volume\n\n\n  var _useState13 = useState(0),\n      _useState14 = _slicedToArray(_useState13, 2),\n      audioTime = _useState14[0],\n      setAudioTime = _useState14[1]; // Current Play Time\n\n\n  var _useState15 = useState(''),\n      _useState16 = _slicedToArray(_useState15, 2),\n      audioCaption = _useState16[0],\n      setAudioCaption = _useState16[1]; // Current Caption Language\n\n\n  var _useState17 = useState(1),\n      _useState18 = _slicedToArray(_useState17, 2),\n      audioPlaybackRate = _useState18[0],\n      setAudioPlaybackRate = _useState18[1]; // Current Playback Rate\n\n\n  useEffect(function () {\n    var stale = false;\n\n    _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var embedAnswer, kdp, listeners, newAudioData;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(audioState === 'loading')) {\n                _context.next = 11;\n                break;\n              }\n\n              _context.next = 3;\n              return KalturaPlayerAPI.embedMedia(audioId, uniqueAudioPlayerId, {\n                autoPlay: true,\n                playbackRateSelector: {\n                  defaultSpeed: 1,\n                  plugin: true\n                }\n              });\n\n            case 3:\n              embedAnswer = _context.sent;\n              setAudioState('playing');\n              _context.next = 7;\n              return embedAnswer.kWidget();\n\n            case 7:\n              kdp = _context.sent;\n              setKalturaDigitalPlayer(kdp);\n              listeners = {\n                playerUpdatePlayhead: function playerUpdatePlayhead(time) {\n                  setAudioTime(Math.floor(time));\n                },\n                newClosedCaptionsData: function newClosedCaptionsData(captionData) {\n                  var processedCaptions = availableCaptions;\n                  processedCaptions[captionData.label] = captionData.captions;\n                  setAvailableCaptions(processedCaptions);\n                },\n                playerPlayEnd: function playerPlayEnd() {\n                  setAudioState('stopped');\n                  /**\n                   * As the audio current time is floored on playhead update\n                   *  when the audio stop because it endend, there is a huge\n                   *  chance that the scrubber will show something like:\n                   *  2:29 <---- scrubber ----> 2:30\n                   *  but the audio will be ended and playbutton will show\n                   *  the reload icon\n                   * In order to fix it, we're manually setting the current\n                   *  audio time to the audio duration\n                   */\n\n                  setAudioTime(audioData.duration);\n                }\n              }; // Loop and bind all the player listeners\n\n              root.Object.keys(listeners).map(function (listenerKey) {\n                kdp.addJsListener(listenerKey, listeners[listenerKey]);\n              });\n\n            case 11:\n              if (!stale) {\n                _context.next = 13;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 13:\n              if (!(audioData.duration === 0)) {\n                _context.next = 20;\n                break;\n              }\n\n              _context.next = 16;\n              return KalturaPlayerAPI.api(audioId);\n\n            case 16:\n              newAudioData = _context.sent;\n\n              if (!stale) {\n                _context.next = 19;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 19:\n              setAudioData(newAudioData);\n\n            case 20:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))();\n\n    return function () {\n      stale = true;\n    };\n  }, [audioId, audioState, uniqueAudioPlayerId, availableCaptions, audioData.duration]);\n\n  var initPlayer = function initPlayer() {\n    setAudioState('loading');\n  };\n\n  if (autoPlay && audioState === '') {\n    initPlayer();\n  }\n\n  var classnames = cx(\"\".concat(prefix, \"--audio-player\"), customClassName);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classnames\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefix, \"--audio-player__embedded-player\"),\n    \"data-autoid\": \"\".concat(stablePrefix, \"--audio-player__audio-\").concat(audioId),\n    id: uniqueAudioPlayerId\n  }), /*#__PURE__*/React.createElement(AudioPlayerThumbnail, {\n    audioId: audioId\n  }), /*#__PURE__*/React.createElement(AudioPlayerPlayButton, {\n    kalturaDigitalPlayer: kalturaDigitalPlayer,\n    initPlayer: initPlayer,\n    audioState: audioState,\n    setAudioState: setAudioState,\n    setDisplayVolumeControl: setDisplayVolumeControl\n  }), /*#__PURE__*/React.createElement(AudioPlayerScrubber, {\n    kalturaDigitalPlayer: kalturaDigitalPlayer,\n    audioDuration: audioData.duration,\n    audioTime: audioTime,\n    setAudioTime: setAudioTime,\n    setDisplayVolumeControl: setDisplayVolumeControl\n  }), /*#__PURE__*/React.createElement(AudioPlayerVolumeControl, {\n    kalturaDigitalPlayer: kalturaDigitalPlayer,\n    audioVolume: audioVolume,\n    setAudioVolume: setAudioVolume,\n    displayVolumeControl: displayVolumeControl,\n    setDisplayVolumeControl: setDisplayVolumeControl\n  }), showPlaybackRateMenu && /*#__PURE__*/React.createElement(AudioPlayerPlaybackRateMenu, {\n    kalturaDigitalPlayer: kalturaDigitalPlayer,\n    availablePlaybackRates: availablePlaybackRates,\n    audioPlaybackRate: audioPlaybackRate,\n    setAudioPlaybackRate: setAudioPlaybackRate,\n    setDisplayVolumeControl: setDisplayVolumeControl\n  }), showCaptionMenu && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(AudioPLayerCaptionsMenu, {\n    kalturaDigitalPlayer: kalturaDigitalPlayer,\n    setDisplayVolumeControl: setDisplayVolumeControl,\n    availableCaptions: availableCaptions,\n    audioCaption: audioCaption,\n    setAudioCaption: setAudioCaption\n  }), (availableCaptions === null || availableCaptions === void 0 ? void 0 : availableCaptions[audioCaption]) && /*#__PURE__*/React.createElement(AudioPlayerCaptionText, {\n    captions: availableCaptions[audioCaption],\n    audioTime: audioTime\n  })));\n};\n\nAudioPlayer.propTypes = {\n  /**\n   * Media ID from Kaltura media platform.\n   */\n  audioId: PropTypes.string.isRequired,\n\n  /**\n   * The CSS class name to apply.\n   */\n  customClassName: PropTypes.string,\n\n  /**\n   * `true` to autoplay the audio on load\n   */\n  autoPlay: PropTypes.bool,\n\n  /**\n   * `true` to show the playback rate button.\n   */\n  showPlaybackRateMenu: PropTypes.bool,\n\n  /**\n   * `true` to show the captions object.\n   */\n  showCaptionMenu: PropTypes.bool,\n\n  /**\n   * The available speed multiplier for playback rate\n   * example: [1, 1.5, 2]\n   */\n  availablePlaybackRates: PropTypes.arrayOf(PropTypes.number)\n  /**\n   * The CSS class name to apply.\n   */\n\n};\nAudioPlayer.defaultProps = {\n  customClassName: '',\n  autoPlay: false,\n  showCaptionMenu: true,\n  showPlaybackRateMenu: true,\n  availablePlaybackRates: [1, 1.5, 2]\n};\nexport default !DDS_AUDIO_PLAYER ? undefined : AudioPlayer;","map":{"version":3,"sources":["/Users/henriquefelixcastro/Downloads/Educathon 2022/educathon-2022-website/node_modules/@carbon/ibmdotcom-react/es/components/AudioPlayer/AudioPlayer.js"],"names":["_regeneratorRuntime","_asyncToGenerator","_slicedToArray","React","useState","useEffect","AudioPLayerCaptionsMenu","AudioPlayerCaptionText","AudioPlayerPlaybackRateMenu","AudioPlayerPlayButton","AudioPlayerScrubber","AudioPlayerThumbnail","AudioPlayerVolumeControl","cx","DDS_AUDIO_PLAYER","ddsSettings","KalturaPlayer","KalturaPlayerAPI","PropTypes","root","settings","uniqueid","stablePrefix","prefix","AudioPlayer","_ref","audioId","customClassName","autoPlay","showCaptionMenu","showPlaybackRateMenu","availablePlaybackRates","_useState","duration","_useState2","audioData","setAudioData","_useState3","_useState4","displayVolumeControl","setDisplayVolumeControl","audioPlayerId","concat","uniqueAudioPlayerId","_useState5","_useState6","kalturaDigitalPlayer","setKalturaDigitalPlayer","_useState7","_useState8","availableCaptions","setAvailableCaptions","_useState9","_useState10","audioState","setAudioState","_useState11","_useState12","audioVolume","setAudioVolume","_useState13","_useState14","audioTime","setAudioTime","_useState15","_useState16","audioCaption","setAudioCaption","_useState17","_useState18","audioPlaybackRate","setAudioPlaybackRate","stale","mark","_callee","embedAnswer","kdp","listeners","newAudioData","wrap","_callee$","_context","prev","next","embedMedia","playbackRateSelector","defaultSpeed","plugin","sent","kWidget","playerUpdatePlayhead","time","Math","floor","newClosedCaptionsData","captionData","processedCaptions","label","captions","playerPlayEnd","Object","keys","map","listenerKey","addJsListener","abrupt","api","stop","initPlayer","classnames","createElement","className","id","audioDuration","Fragment","propTypes","string","isRequired","bool","arrayOf","number","defaultProps","undefined"],"mappings":"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","sourcesContent":["import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\n/**\n * Copyright IBM Corp. 2016, 2022\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React, { useState, useEffect } from 'react';\nimport AudioPLayerCaptionsMenu from './AudioPlayerCaptionsMenu';\nimport AudioPlayerCaptionText from './AudioPlayerCaptionText';\nimport AudioPlayerPlaybackRateMenu from './AudioPlayerPlaybackRateMenu';\nimport AudioPlayerPlayButton from './AudioPlayerPlayButton';\nimport AudioPlayerScrubber from './AudioPlayerScrubber';\nimport AudioPlayerThumbnail from './AudioPlayerThumbnail';\nimport AudioPlayerVolumeControl from './AudioPlayerVolumeControl';\nimport cx from 'classnames';\nimport { DDS_AUDIO_PLAYER } from '../../internal/FeatureFlags';\nimport ddsSettings from '../../internal/vendor/@carbon/ibmdotcom-utilities/utilities/settings/settings';\nimport { KalturaPlayer as KalturaPlayerAPI } from '@carbon/ibmdotcom-services/es/services';\nimport PropTypes from 'prop-types';\nimport root from 'window-or-global';\nimport settings from 'carbon-components/es/globals/js/settings';\nimport uniqueid from '../../internal/vendor/@carbon/ibmdotcom-utilities/utilities/uniqueid/uniqueid';\nvar stablePrefix = ddsSettings.stablePrefix;\nvar prefix = settings.prefix;\n/**\n * AudioPlayer component.\n */\n\nvar AudioPlayer = function AudioPlayer(_ref) {\n  var audioId = _ref.audioId,\n      customClassName = _ref.customClassName,\n      autoPlay = _ref.autoPlay,\n      showCaptionMenu = _ref.showCaptionMenu,\n      showPlaybackRateMenu = _ref.showPlaybackRateMenu,\n      availablePlaybackRates = _ref.availablePlaybackRates;\n\n  var _useState = useState({\n    duration: 0\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      audioData = _useState2[0],\n      setAudioData = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      displayVolumeControl = _useState4[0],\n      setDisplayVolumeControl = _useState4[1];\n\n  var audioPlayerId = uniqueid(\"audio-player__audio-\".concat(audioId, \"-\"));\n  var uniqueAudioPlayerId = \"\".concat(prefix, \"--\").concat(audioPlayerId);\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      kalturaDigitalPlayer = _useState6[0],\n      setKalturaDigitalPlayer = _useState6[1]; // The KDP Object\n\n\n  var _useState7 = useState({}),\n      _useState8 = _slicedToArray(_useState7, 2),\n      availableCaptions = _useState8[0],\n      setAvailableCaptions = _useState8[1]; // All Available Captions\n\n  /**\n   * The current state of the player\n   *\n   * @param {string} '' - Player not initialized\n   * @param {string} 'loading' - Player initialized but waiting kdp to load\n   * @param {string} 'playing' - Player is playing\n   * @param {string} 'paused' - Player is paused\n   * @param {string} 'stopped' - Player stopped playing (audio finished)\n   */\n\n\n  var _useState9 = useState(''),\n      _useState10 = _slicedToArray(_useState9, 2),\n      audioState = _useState10[0],\n      setAudioState = _useState10[1];\n\n  var _useState11 = useState(1),\n      _useState12 = _slicedToArray(_useState11, 2),\n      audioVolume = _useState12[0],\n      setAudioVolume = _useState12[1]; // Current Volume\n\n\n  var _useState13 = useState(0),\n      _useState14 = _slicedToArray(_useState13, 2),\n      audioTime = _useState14[0],\n      setAudioTime = _useState14[1]; // Current Play Time\n\n\n  var _useState15 = useState(''),\n      _useState16 = _slicedToArray(_useState15, 2),\n      audioCaption = _useState16[0],\n      setAudioCaption = _useState16[1]; // Current Caption Language\n\n\n  var _useState17 = useState(1),\n      _useState18 = _slicedToArray(_useState17, 2),\n      audioPlaybackRate = _useState18[0],\n      setAudioPlaybackRate = _useState18[1]; // Current Playback Rate\n\n\n  useEffect(function () {\n    var stale = false;\n\n    _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var embedAnswer, kdp, listeners, newAudioData;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(audioState === 'loading')) {\n                _context.next = 11;\n                break;\n              }\n\n              _context.next = 3;\n              return KalturaPlayerAPI.embedMedia(audioId, uniqueAudioPlayerId, {\n                autoPlay: true,\n                playbackRateSelector: {\n                  defaultSpeed: 1,\n                  plugin: true\n                }\n              });\n\n            case 3:\n              embedAnswer = _context.sent;\n              setAudioState('playing');\n              _context.next = 7;\n              return embedAnswer.kWidget();\n\n            case 7:\n              kdp = _context.sent;\n              setKalturaDigitalPlayer(kdp);\n              listeners = {\n                playerUpdatePlayhead: function playerUpdatePlayhead(time) {\n                  setAudioTime(Math.floor(time));\n                },\n                newClosedCaptionsData: function newClosedCaptionsData(captionData) {\n                  var processedCaptions = availableCaptions;\n                  processedCaptions[captionData.label] = captionData.captions;\n                  setAvailableCaptions(processedCaptions);\n                },\n                playerPlayEnd: function playerPlayEnd() {\n                  setAudioState('stopped');\n                  /**\n                   * As the audio current time is floored on playhead update\n                   *  when the audio stop because it endend, there is a huge\n                   *  chance that the scrubber will show something like:\n                   *  2:29 <---- scrubber ----> 2:30\n                   *  but the audio will be ended and playbutton will show\n                   *  the reload icon\n                   * In order to fix it, we're manually setting the current\n                   *  audio time to the audio duration\n                   */\n\n                  setAudioTime(audioData.duration);\n                }\n              }; // Loop and bind all the player listeners\n\n              root.Object.keys(listeners).map(function (listenerKey) {\n                kdp.addJsListener(listenerKey, listeners[listenerKey]);\n              });\n\n            case 11:\n              if (!stale) {\n                _context.next = 13;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 13:\n              if (!(audioData.duration === 0)) {\n                _context.next = 20;\n                break;\n              }\n\n              _context.next = 16;\n              return KalturaPlayerAPI.api(audioId);\n\n            case 16:\n              newAudioData = _context.sent;\n\n              if (!stale) {\n                _context.next = 19;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 19:\n              setAudioData(newAudioData);\n\n            case 20:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))();\n\n    return function () {\n      stale = true;\n    };\n  }, [audioId, audioState, uniqueAudioPlayerId, availableCaptions, audioData.duration]);\n\n  var initPlayer = function initPlayer() {\n    setAudioState('loading');\n  };\n\n  if (autoPlay && audioState === '') {\n    initPlayer();\n  }\n\n  var classnames = cx(\"\".concat(prefix, \"--audio-player\"), customClassName);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classnames\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefix, \"--audio-player__embedded-player\"),\n    \"data-autoid\": \"\".concat(stablePrefix, \"--audio-player__audio-\").concat(audioId),\n    id: uniqueAudioPlayerId\n  }), /*#__PURE__*/React.createElement(AudioPlayerThumbnail, {\n    audioId: audioId\n  }), /*#__PURE__*/React.createElement(AudioPlayerPlayButton, {\n    kalturaDigitalPlayer: kalturaDigitalPlayer,\n    initPlayer: initPlayer,\n    audioState: audioState,\n    setAudioState: setAudioState,\n    setDisplayVolumeControl: setDisplayVolumeControl\n  }), /*#__PURE__*/React.createElement(AudioPlayerScrubber, {\n    kalturaDigitalPlayer: kalturaDigitalPlayer,\n    audioDuration: audioData.duration,\n    audioTime: audioTime,\n    setAudioTime: setAudioTime,\n    setDisplayVolumeControl: setDisplayVolumeControl\n  }), /*#__PURE__*/React.createElement(AudioPlayerVolumeControl, {\n    kalturaDigitalPlayer: kalturaDigitalPlayer,\n    audioVolume: audioVolume,\n    setAudioVolume: setAudioVolume,\n    displayVolumeControl: displayVolumeControl,\n    setDisplayVolumeControl: setDisplayVolumeControl\n  }), showPlaybackRateMenu && /*#__PURE__*/React.createElement(AudioPlayerPlaybackRateMenu, {\n    kalturaDigitalPlayer: kalturaDigitalPlayer,\n    availablePlaybackRates: availablePlaybackRates,\n    audioPlaybackRate: audioPlaybackRate,\n    setAudioPlaybackRate: setAudioPlaybackRate,\n    setDisplayVolumeControl: setDisplayVolumeControl\n  }), showCaptionMenu && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(AudioPLayerCaptionsMenu, {\n    kalturaDigitalPlayer: kalturaDigitalPlayer,\n    setDisplayVolumeControl: setDisplayVolumeControl,\n    availableCaptions: availableCaptions,\n    audioCaption: audioCaption,\n    setAudioCaption: setAudioCaption\n  }), (availableCaptions === null || availableCaptions === void 0 ? void 0 : availableCaptions[audioCaption]) && /*#__PURE__*/React.createElement(AudioPlayerCaptionText, {\n    captions: availableCaptions[audioCaption],\n    audioTime: audioTime\n  })));\n};\n\nAudioPlayer.propTypes = {\n  /**\n   * Media ID from Kaltura media platform.\n   */\n  audioId: PropTypes.string.isRequired,\n\n  /**\n   * The CSS class name to apply.\n   */\n  customClassName: PropTypes.string,\n\n  /**\n   * `true` to autoplay the audio on load\n   */\n  autoPlay: PropTypes.bool,\n\n  /**\n   * `true` to show the playback rate button.\n   */\n  showPlaybackRateMenu: PropTypes.bool,\n\n  /**\n   * `true` to show the captions object.\n   */\n  showCaptionMenu: PropTypes.bool,\n\n  /**\n   * The available speed multiplier for playback rate\n   * example: [1, 1.5, 2]\n   */\n  availablePlaybackRates: PropTypes.arrayOf(PropTypes.number)\n  /**\n   * The CSS class name to apply.\n   */\n\n};\nAudioPlayer.defaultProps = {\n  customClassName: '',\n  autoPlay: false,\n  showCaptionMenu: true,\n  showPlaybackRateMenu: true,\n  availablePlaybackRates: [1, 1.5, 2]\n};\nexport default !DDS_AUDIO_PLAYER ? undefined : AudioPlayer;"]},"metadata":{},"sourceType":"module"}